\begin{Schunk}
\begin{Sinput}
 ## Check preconditions:
 mod1 <- lm(policy ~ revDisc, data = dat1)
 mod2 <- lm(sysRac ~ revDisc, data = dat1)
 mod3 <- lm(policy ~ sysRac, data = dat1)
 summary(mod1)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = policy ~ revDisc, data = dat1)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6840 -0.8584  0.1331  0.7941  3.2112 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  4.22306    0.29023  14.551   <2e-16 ***
revDisc     -0.13904    0.07465  -1.862    0.066 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.17 on 85 degrees of freedom
Multiple R-squared:  0.03921,	Adjusted R-squared:  0.02791 
F-statistic: 3.469 on 1 and 85 DF,  p-value: 0.06599
\end{Soutput}
\begin{Sinput}
 summary(mod2)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = sysRac ~ revDisc, data = dat1)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2292 -0.6877  0.0492  0.5861  2.3708 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  4.15540    0.24043   17.28   <2e-16 ***
revDisc     -0.12615    0.06184   -2.04   0.0445 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9695 on 85 degrees of freedom
Multiple R-squared:  0.04667,	Adjusted R-squared:  0.03545 
F-statistic: 4.161 on 1 and 85 DF,  p-value: 0.04447
\end{Soutput}
\begin{Sinput}
 summary(mod3)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = policy ~ sysRac, data = dat1)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7700 -0.5593  0.0255  0.6277  3.6835 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   0.9295     0.3896   2.386   0.0193 *  
sysRac        0.7557     0.1014   7.450 7.14e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9286 on 85 degrees of freedom
Multiple R-squared:  0.395,	Adjusted R-squared:  0.3879 
F-statistic:  55.5 on 1 and 85 DF,  p-value: 7.145e-11
\end{Soutput}
\begin{Sinput}
 ## Fit partial model:
 mod4 <- lm(policy ~ revDisc + sysRac, data = dat1)
 ## Extract parameter estimates:
 a <- coef(mod2)["revDisc"]
 b <- coef(mod4)["sysRac"]
 seA <- sqrt(diag(vcov(mod2)))["revDisc"]
 seB <- sqrt(diag(vcov(mod4)))["sysRac"]
 sobelSE <- sqrt(a^2 * seB^2 + b^2 * seA^2)
 sobelZ <- (a * b) / sobelSE
 sobelZ
\end{Sinput}
\begin{Soutput}
  revDisc 
-1.960368 
\end{Soutput}
\begin{Sinput}
 sobelP <- 2 * pnorm(sobelZ, lower = TRUE)
 sobelP
\end{Sinput}
\begin{Soutput}
  revDisc 
0.0499528 
\end{Soutput}
\end{Schunk}
